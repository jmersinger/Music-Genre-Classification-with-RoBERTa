{"cells":[{"cell_type":"code","execution_count":null,"id":"fWk6puvn-C5-","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14352,"status":"ok","timestamp":1734001994777,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"fWk6puvn-C5-","outputId":"0a78e549-fb1c-4364-c4f0-b56f566ca5f3"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"id":"BfB_vBYP-6UC","metadata":{"id":"BfB_vBYP-6UC"},"outputs":[],"source":["import pandas as pd\n","import kagglehub\n","\n","# Download data and create genre column for tracks using artists\n","def download_and_clean():\n","\n","    path = kagglehub.dataset_download(\"yamaerenay/spotify-dataset-19212020-600k-tracks\")\n","    artists_path = path + '/artists.csv'\n","    tracks_path = path + '/tracks.csv'\n","\n","    artists_df = pd.read_csv(artists_path)\n","    tracks_df = pd.read_csv(tracks_path)\n","\n","    artists_df = artists_df.dropna().drop_duplicates()\n","    tracks_df = tracks_df.dropna().drop_duplicates()\n","\n","    artists_df = artists_df[artists_df['genres'].apply(lambda x: len(eval(x)) > 0 if isinstance(x, str) else False)]\n","\n","    valid_artists = set(artists_df['name'])\n","    tracks_df = tracks_df[tracks_df['artists'].apply(lambda x: all(artist in valid_artists for artist in eval(x)) if isinstance(x, str) else False)]\n","\n","    artist_to_genres = dict(zip(artists_df['name'], artists_df['genres']))\n","\n","    def get_genres_for_track(artists_list):\n","        if isinstance(artists_list, str):\n","            try:\n","                artists_list = eval(artists_list)\n","                genres = [genre for artist in artists_list if artist in artist_to_genres for genre in eval(artist_to_genres[artist])]\n","                return list(set(genres))\n","            except:\n","                return []\n","        return []\n","\n","    tracks_df['genres'] = tracks_df['artists'].apply(get_genres_for_track)\n","\n","    artists_df.to_csv('/content/drive/MyDrive/nlp-proj/data/cleaned_data/cleaned_artists.csv', index=False)\n","    tracks_df.to_csv('/content/drive/MyDrive/nlp-proj/data/cleaned_data/cleaned_tracks.csv', index=False)\n","\n","    return artists_df, tracks_df\n"]},{"cell_type":"code","execution_count":null,"id":"175073ea-4071-4aaf-a332-e354846b474c","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":47923,"status":"ok","timestamp":1734002043238,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"175073ea-4071-4aaf-a332-e354846b474c","outputId":"314f6c4f-4380-421c-fb63-5637045524af"},"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading from https://www.kaggle.com/api/v1/datasets/download/yamaerenay/spotify-dataset-19212020-600k-tracks?dataset_version_number=1...\n"]},{"output_type":"stream","name":"stderr","text":["100%|██████████| 193M/193M [00:02<00:00, 79.9MB/s]"]},{"output_type":"stream","name":"stdout","text":["Extracting files...\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["# from data.cleaning import download_and_clean\n","\n","artists, tracks = download_and_clean()"]},{"cell_type":"code","execution_count":null,"id":"d54a8e77-2193-4fe4-8043-282cc51d056f","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":98,"status":"ok","timestamp":1734002043334,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"d54a8e77-2193-4fe4-8043-282cc51d056f","outputId":"93b03724-faaa-4c90-d2e3-7275dc4675d6"},"outputs":[{"output_type":"stream","name":"stdout","text":["                         id  followers                      genres  \\\n","45   0VLMVnVbJyJ4oyZs2L3Yl2       71.0          ['carnaval cadiz']   \n","46   0dt23bs4w8zx154C5xdVyl       63.0          ['carnaval cadiz']   \n","47   0pGhoB99qpEJEsBQxgaskQ       64.0          ['carnaval cadiz']   \n","48   3HDrX2OtSuXLW5dLR85uN3       53.0          ['carnaval cadiz']   \n","136  22mLrN5fkppmuUPsHx6i2G       59.0  ['classical harp', 'harp']   \n","\n","                             name  popularity  \n","45   Las Viudas De Los Bisabuelos           6  \n","46              Los De Capuchinos           5  \n","47             Los “Pofesionales”           7  \n","48      Los Que No Paran De Rajar           6  \n","136                   Vera Dulova           3  \n"]}],"source":["print(artists.head())"]},{"cell_type":"code","execution_count":null,"id":"07ae631a-3033-429d-8484-1f0d06c826a7","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1,"status":"ok","timestamp":1734002043334,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"07ae631a-3033-429d-8484-1f0d06c826a7","outputId":"8cc769eb-0825-4e3f-c516-57a7cb559e65"},"outputs":[{"output_type":"stream","name":"stdout","text":["                       id                                name  popularity  \\\n","2  07A5yehtSnoedViJAZkNnc  Vivo para Quererte - Remasterizado           0   \n","3  08FmqUhxtyLTn6pAh6bk45       El Prisionero - Remasterizado           0   \n","4  08y9GfoqCWfOGsKdwojr5e                 Lady of the Evening           0   \n","5  0BRXJHRNGQ3W4v9frnSfhu                           Ave Maria           0   \n","7  0IA0Hju8CAgYfV1hwhidBH                             La Java           0   \n","\n","   duration_ms  explicit              artists                  id_artists  \\\n","2       181640         0  ['Ignacio Corsini']  ['5LiOoJbxVSAMkBS2fUm3X2']   \n","3       176907         0  ['Ignacio Corsini']  ['5LiOoJbxVSAMkBS2fUm3X2']   \n","4       163080         0      ['Dick Haymes']  ['3BiJGZsyX9sJchTqcSA7Su']   \n","5       178933         0      ['Dick Haymes']  ['3BiJGZsyX9sJchTqcSA7Su']   \n","7       161427         0      ['Mistinguett']  ['4AxgXfD7ISvJSTObqm4aIE']   \n","\n","  release_date  danceability  energy  ...  loudness  mode  speechiness  \\\n","2   1922-03-21         0.434  0.1770  ...   -21.180     1       0.0512   \n","3   1922-03-21         0.321  0.0946  ...   -27.961     1       0.0504   \n","4         1922         0.402  0.1580  ...   -16.900     0       0.0390   \n","5         1922         0.227  0.2610  ...   -12.343     1       0.0382   \n","7         1922         0.563  0.1840  ...   -13.757     1       0.0512   \n","\n","   acousticness  instrumentalness  liveness  valence    tempo  time_signature  \\\n","2         0.994          0.021800    0.2120   0.4570  130.418               5   \n","3         0.995          0.918000    0.1040   0.3970  169.980               3   \n","4         0.989          0.130000    0.3110   0.1960  103.220               4   \n","5         0.994          0.247000    0.0977   0.0539  118.891               4   \n","7         0.993          0.000016    0.3250   0.6540  133.088               3   \n","\n","                                              genres  \n","2                             [tango, vintage tango]  \n","3                             [tango, vintage tango]  \n","4  [adult standards, easy listening, lounge, big ...  \n","5  [adult standards, easy listening, lounge, big ...  \n","7                                  [vintage chanson]  \n","\n","[5 rows x 21 columns]\n"]}],"source":["print(tracks.head())"]},{"cell_type":"code","execution_count":null,"id":"9364f6fa-96a5-40dd-8d47-2a78482f8567","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1734002043425,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"9364f6fa-96a5-40dd-8d47-2a78482f8567","outputId":"d1ae2e1c-91de-4a70-fdc4-59d3b1090e25"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["4706"]},"metadata":{},"execution_count":7}],"source":["# The next few cells create a multi-hot vector for storing the genre labels for modeling\n","\n","from itertools import chain\n","all_genres = set(chain.from_iterable(tracks[\"genres\"]))\n","len(all_genres)\n","# all_genres"]},{"cell_type":"code","execution_count":null,"id":"af999b92-4010-4fb9-b5da-6f6cc67380a1","metadata":{"id":"af999b92-4010-4fb9-b5da-6f6cc67380a1"},"outputs":[],"source":["genre_to_index = {genre: idx for idx, genre in enumerate(sorted(all_genres))}\n","# genre_to_index"]},{"cell_type":"code","execution_count":null,"id":"2f8f25fb-1407-42a6-9989-c04e25dd56c1","metadata":{"id":"2f8f25fb-1407-42a6-9989-c04e25dd56c1"},"outputs":[],"source":["def multihot_vector(genres, index_dict):\n","    multihot = [0] * len(index_dict)\n","    for genre in genres:\n","        multihot[index_dict[genre]] = 1\n","    return multihot"]},{"cell_type":"code","execution_count":null,"id":"428fca29-7f55-4b3e-9537-e2ef8afb9573","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":458},"executionInfo":{"elapsed":33166,"status":"ok","timestamp":1734002076664,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"428fca29-7f55-4b3e-9537-e2ef8afb9573","outputId":"38468da3-895f-4afc-bdd4-86fc3fa9d54e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["2         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","3         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","4         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","5         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","7         [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","                                ...                        \n","586667    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","586668    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","586669    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","586670    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","586671    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","Name: multi_hot_genres, Length: 499064, dtype: object"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>multi_hot_genres</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>586667</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>586668</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>586669</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>586670</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>586671</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>499064 rows × 1 columns</p>\n","</div><br><label><b>dtype:</b> object</label>"]},"metadata":{},"execution_count":10}],"source":["tracks[\"multi_hot_genres\"] = tracks[\"genres\"].apply(\n","    lambda genres: multihot_vector(genres, genre_to_index)\n",")\n","tracks[\"multi_hot_genres\"]"]},{"cell_type":"code","execution_count":null,"id":"4d5aedaf-66d2-4faf-aa2e-bbe8c2504aec","metadata":{"id":"4d5aedaf-66d2-4faf-aa2e-bbe8c2504aec"},"outputs":[],"source":["# Split the data into 80-10-10\n","\n","from sklearn.model_selection import train_test_split\n","\n","X = tracks[[\"name\", \"popularity\", \"duration_ms\", \"explicit\", \"release_date\", \"danceability\", \"energy\", \"key\", \"loudness\", \"mode\", \"speechiness\", \"acousticness\", \"instrumentalness\", \"liveness\", \"valence\", \"tempo\", \"time_signature\"]]\n","y = tracks[\"multi_hot_genres\"].tolist()\n","\n","X_train, X_temp, y_train, y_temp = train_test_split(X, y, test_size=0.2, random_state=478)\n","X_dev, X_test, y_dev, y_test = train_test_split(X_temp, y_temp, test_size=0.5, random_state=478)"]},{"cell_type":"code","execution_count":null,"id":"34f732a6-c0f2-4d27-b749-2fa9ebef55b7","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1734002078768,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"34f732a6-c0f2-4d27-b749-2fa9ebef55b7","outputId":"23d3b4c7-945f-4d13-c364-81de1aa674b6"},"outputs":[{"output_type":"stream","name":"stdout","text":["Train set size: 399251\n","Dev set size: 49906\n","Test set size: 49907\n"]}],"source":["print(f\"Train set size: {len(X_train)}\")\n","print(f\"Dev set size: {len(X_dev)}\")\n","print(f\"Test set size: {len(X_test)}\")"]},{"cell_type":"code","execution_count":null,"id":"cc59b6ea-b98e-42d5-8a6c-91991e03982c","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":139953,"status":"ok","timestamp":1734002311567,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"cc59b6ea-b98e-42d5-8a6c-91991e03982c","outputId":"b3183346-da7a-4fa1-8492-cd04abd5e3a7"},"outputs":[{"output_type":"stream","name":"stdout","text":["Original number of labels: 4706\n","Filtered number of labels: 1529\n"]}],"source":["# Drop genres that have less than 100 occurences\n","import numpy as np\n","\n","label_counts = np.sum(y_train, axis=0)\n","\n","threshold =100\n","selected_labels = np.where(label_counts >= threshold)[0]\n","\n","def filter_labels(y, selected_labels):\n","    return np.array([[y_sample[i] for i in selected_labels] for y_sample in y])\n","\n","y_train = filter_labels(y_train, selected_labels)\n","y_dev = filter_labels(y_dev, selected_labels)\n","y_test = filter_labels(y_test, selected_labels)\n","\n","filtered_genre_to_index = {genre: idx for idx, genre in enumerate(selected_labels)}\n","index_to_genre = {v: k for k, v in filtered_genre_to_index.items()}\n","\n","print(f\"Original number of labels: {len(label_counts)}\")\n","print(f\"Filtered number of labels: {len(selected_labels)}\")\n"]},{"cell_type":"code","execution_count":null,"id":"b9aa7530-f23d-4471-ac80-0e9c56d18d66","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4360,"status":"ok","timestamp":1734002315926,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"b9aa7530-f23d-4471-ac80-0e9c56d18d66","outputId":"11136829-8d9b-4cb9-bc9e-7c36919fe9da"},"outputs":[{"output_type":"stream","name":"stdout","text":["Train set size after filtering: 386974\n","Dev set size after filtering: 48297\n","Test set size after filtering: 48376\n"]}],"source":["# Drop rows with no positive labels\n","def remove_empty_labels(X, y):\n","    non_empty_indices = [i for i, labels in enumerate(y) if np.sum(labels) > 0]\n","    X_filtered = X.iloc[non_empty_indices].reset_index(drop=True)\n","    y_filtered = np.array([y[i] for i in non_empty_indices])\n","    return X_filtered, y_filtered\n","\n","X_train, y_train = remove_empty_labels(X_train, y_train)\n","X_dev, y_dev = remove_empty_labels(X_dev, y_dev)\n","X_test, y_test = remove_empty_labels(X_test, y_test)\n","\n","print(f\"Train set size after filtering: {len(X_train)}\")\n","print(f\"Dev set size after filtering: {len(X_dev)}\")\n","print(f\"Test set size after filtering: {len(X_test)}\")"]},{"cell_type":"code","execution_count":null,"id":"6f8a9644-ecff-49a1-a508-e5519cc64df0","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":301,"referenced_widgets":["12ad8940c62041619cb896596750d01a","16998aabcc8d4bb9a3c0f24800597c91","ee0d127edd664d4ea78ae374ecf0a93f","d550d967cb1b43d8add0a84dc0c3588f","bb89508e2e5548afad39a041130f3cef","8b11fd7c38d449f6a1909dc73efc5263","c3fd94636d32446f8066458ea73c0e5b","c66ef153c98342239156e90731f203a7","66f2ec1c94ff4f9da0629c4c653a6373","a14fd1192f5e4663a7eec560ebd825d7","b00718c1321a484594e0d8f1dcd76cbf","62dcbe9ecca2439bafdace5ffd229607","3785465a5a52458aa968ce326abfa71b","440f0731990a42e2b35e003e975f81d0","c7aecc3a1a954aa89a0aa9f223c00629","4bf7454220ad468a8401938b9d387e6b","2018cfeddfee44ffb7cd8de0a5a72149","35941ca2a9734665ad3cb4062929189c","70da06d6eaae45c9b51176e36ac0c2ce","a58682d922c24eb18949e2948c71742d","6b010ab2676344ad9b4fc41fe4ffd8ba","758210704e5f4e3d8390eeab0c1dc9a9","ce2b282816ac4fc6a5cab01138c7e7dd","0a10cdc249574a07a6ece57d7a5407af","242490e53cde4f5295f0d76d074cba17","a3aa7be523c5445b8a9bb3df6739148e","700b4e3ca58e45329d86b7bee6d25b81","888252ddd7f043da8e31fbb067996dfb","9adee565216642c589d37b05c5a5c8f0","96274012f7da4572961b875390989a02","cf9ecf4eef3b4af9822313ec536d2cd8","456115a7f63646989c17613aee67c1cf","0329d59f979549d48d568b39c972c358","5508438f43134079b399a37af2c687fa","fb6ba57418d345e68c1aa569b340497d","8bda381ca84e4e67b14a775a22cb42a2","32db3c3e49b14b48851584e1348b573b","231765b191f047f583aafdbd59583101","3370ccc1b69d4c3e99b742b26e0da638","03fa76a5ad4f4d428d5e37a43f657068","460219bcc9194e0a9ef8b92dc831293b","f6c3339df8244572bf8b6b1415ab3538","33ca2f3509134a7ca85a865160604dc9","2af7e352b446441fafbd2a42c7066337","438dc3c9c9474b4ebbeb2198f7310cce","946ef0e479954acbbaff5a3b115bfa49","25e0421b61f0403c9f44b5464a5a1fb0","c8182fd7b96540d7a600b5dd27a0dc52","9a2d2f6982d14a7190825a500a1f5617","21a8ab9d99fd4b7b96f4c5710b1cacc8","eecc23c817954bf8b88f47d4044363ca","55544cb3f8a4492e9d7d7f30c6760d7e","6a9acf3444c14dadb2637a6259327f77","fc969e441dbc4e42a042251df159c66e","e6e6f5c364844126a57b4c3ac013484c"]},"executionInfo":{"elapsed":23919,"status":"ok","timestamp":1734002342453,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"6f8a9644-ecff-49a1-a508-e5519cc64df0","outputId":"fbf98b7b-dd20-4c3b-9642-dd77e8d3274e"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["tokenizer_config.json:   0%|          | 0.00/25.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"12ad8940c62041619cb896596750d01a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"62dcbe9ecca2439bafdace5ffd229607"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ce2b282816ac4fc6a5cab01138c7e7dd"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["tokenizer.json:   0%|          | 0.00/1.36M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5508438f43134079b399a37af2c687fa"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/481 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"438dc3c9c9474b4ebbeb2198f7310cce"}},"metadata":{}}],"source":["from transformers import RobertaModel, RobertaTokenizer\n","import torch\n","import torch.nn as nn\n","from transformers import TrainingArguments, Trainer\n","from sklearn.metrics import precision_score, recall_score, f1_score, accuracy_score, jaccard_score, hamming_loss\n","import numpy as np\n","\n","tokenizer = RobertaTokenizer.from_pretrained(\"roberta-base\")"]},{"cell_type":"code","execution_count":null,"id":"g3tbqyFpHTaW","metadata":{"id":"g3tbqyFpHTaW"},"outputs":[],"source":["# Tokenizing and preparing the feature for modeling\n","def tokenize_data(X):\n","    combined_text = X.apply(lambda row: \" \".join(row.astype(str)), axis=1)\n","\n","    # Tokenize the combined text\n","    return tokenizer(\n","        combined_text.tolist(),\n","        padding=True,\n","        truncation=True,\n","        # max_length=32,\n","        return_tensors=\"pt\"\n","    )\n","\n","# Dataset preparation\n","class MultiLabelDataset(torch.utils.data.Dataset):\n","    def __init__(self, X, y):\n","        tokenized = tokenize_data(X)\n","\n","        self.input_ids = tokenized[\"input_ids\"]\n","        self.attention_mask = tokenized[\"attention_mask\"]\n","        self.labels = torch.tensor(y)\n","\n","        token_lengths = [len(ids) for ids in self.input_ids]\n","        print(f\"Token length range: {min(token_lengths)} to {max(token_lengths)}\")\n","\n","    def __len__(self):\n","        return len(self.labels)\n","\n","    def __getitem__(self, idx):\n","        return {\n","            \"input_ids\": self.input_ids[idx],\n","            \"attention_mask\": self.attention_mask[idx],\n","            \"labels\": self.labels[idx]\n","        }"]},{"cell_type":"code","execution_count":null,"id":"E43VKZsBHVat","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":225537,"status":"ok","timestamp":1734002568078,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"E43VKZsBHVat","outputId":"cf6857cd-68df-4749-ff9b-be6b7109f7ba"},"outputs":[{"output_type":"stream","name":"stdout","text":["Token length range: 187 to 187\n","Token length range: 156 to 156\n","Token length range: 171 to 171\n"]}],"source":["train_dataset = MultiLabelDataset(X_train, y_train)\n","dev_dataset = MultiLabelDataset(X_dev, y_dev)\n","test_dataset = MultiLabelDataset(X_test, y_test)"]},{"cell_type":"code","execution_count":null,"id":"b6f708e1-5d64-4f86-beca-030d73f16309","metadata":{"id":"b6f708e1-5d64-4f86-beca-030d73f16309"},"outputs":[],"source":["# RoBERTa, following similar to the model described in “Punk or Funk: Understanding the Performance of RoBERTa on Music Genre Classification.”\n","class MultiLabelRoBERTa(nn.Module):\n","    def __init__(self, num_labels):\n","        super(MultiLabelRoBERTa, self).__init__()\n","        self.roberta = RobertaModel.from_pretrained(\"roberta-base\")\n","        self.classifier = nn.Sequential(\n","            nn.Linear(self.roberta.config.hidden_size, 128),\n","            nn.ReLU(),\n","            nn.Dropout(0.3),\n","            nn.Linear(128, num_labels)\n","        )\n","\n","    def forward(self, input_ids, attention_mask, labels=None):\n","        outputs = self.roberta(input_ids=input_ids, attention_mask=attention_mask)\n","\n","        logits = self.classifier(outputs.pooler_output)\n","\n","        loss = None\n","        if labels is not None:\n","            criterion = nn.BCEWithLogitsLoss()\n","            loss = criterion(logits, labels.float())\n","\n","        return {\"loss\": loss, \"logits\": logits}\n","\n","# Metrics\n","def compute_metrics(pred, threshold_range=(0.05, 0.55, 0.05), prob=True):\n","    logits, labels = pred\n","    output = logits\n","    if prob:\n","        output = torch.sigmoid(torch.tensor(logits))\n","\n","    # Find probability range\n","    prob_min = output.min().item()\n","    prob_max = output.max().item()\n","    prob_mean = output.mean().item()\n","\n","    def prob_threshold_pred(output, threshold):\n","        if isinstance(output, np.ndarray):\n","            return (output > threshold).astype(int)\n","        return (output > threshold).int()\n","\n","    def calc_metrics(labels, predictions):\n","        subset_accuracy = accuracy_score(labels, predictions)\n","        precision = precision_score(labels, predictions, average=\"micro\")\n","        recall = recall_score(labels, predictions, average=\"micro\")\n","        f1 = f1_score(labels, predictions, average=\"micro\")\n","        jaccard = jaccard_score(labels, predictions, average='samples')\n","        hamming = hamming_loss(labels, predictions)\n","\n","        return subset_accuracy, precision, recall, f1, jaccard, hamming\n","\n","    threshold_results = {}\n","    for threshold in np.arange(*threshold_range):\n","        predictions = prob_threshold_pred(output, threshold)\n","        subset_accuracy, precision, recall, f1, jaccard, hamming = calc_metrics(labels, predictions)\n","        threshold_results[threshold] = {\n","            \"accuracy\": subset_accuracy,\n","            \"precision\": precision,\n","            \"recall\": recall,\n","            \"f1\": f1,\n","            \"hamming\": hamming,\n","            \"jaccard\": jaccard\n","        }\n","\n","    # Find optimal probability threshold\n","    optimal_threshold = max(threshold_results, key=lambda t: threshold_results[t][\"f1\"])\n","    optimal_threshold_metrics = threshold_results[optimal_threshold]\n","\n","    return {\n","        \"prob_min\": prob_min,\n","        \"prob_max\": prob_max,\n","        \"prob_mean\": prob_mean,\n","        \"optimal_threshold\": optimal_threshold,\n","        \"optimal_threshold_accuracy\": optimal_threshold_metrics[\"accuracy\"],\n","        \"optimal_threshold_precision\": optimal_threshold_metrics[\"precision\"],\n","        \"optimal_threshold_recall\": optimal_threshold_metrics[\"recall\"],\n","        \"optimal_threshold_f1\": optimal_threshold_metrics[\"f1\"],\n","        \"optimal_threshold_hamming\": optimal_threshold_metrics[\"hamming\"],\n","        \"optimal_threshold_jaccard\": optimal_threshold_metrics[\"jaccard\"],\n","    }\n"]},{"cell_type":"code","execution_count":null,"id":"c667123f-dd36-4247-a228-36607069bf75","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":104,"referenced_widgets":["1dbb6fbb00124f5ea2bb59122be83c31","75d3756e74944ba19406cc24aa58c5ce","52f95d752c7f4db98619c721f2a93b2b","4ec008e869f44abca34f7518260a114c","a9de6250046e4e8dacd4d0817d31ab87","0dfa43fa48a1458b9e0cb7227940ece1","fb9dc9a1da02497595ca5bcda139dc8e","c8ed270d3a1f4f90b3a7cfe30d5add7a","01e439f92f284f52b67eb5df4a4d3454","f199adcfbb6d4c9d9d32e5d695459fed","32db3ee74a484beba2736f4d70ae674e"]},"executionInfo":{"elapsed":2571,"status":"ok","timestamp":1734002570647,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"},"user_tz":300},"id":"c667123f-dd36-4247-a228-36607069bf75","outputId":"c3f8fe93-8be5-4abf-b774-f1fd75fe412f"},"outputs":[{"output_type":"display_data","data":{"text/plain":["model.safetensors:   0%|          | 0.00/499M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1dbb6fbb00124f5ea2bb59122be83c31"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of RobertaModel were not initialized from the model checkpoint at roberta-base and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}],"source":["# Initialize the model\n","def initialize_model():\n","    num_labels = len(y_train[0])\n","    model = MultiLabelRoBERTa(num_labels=num_labels)\n","    model.roberta.gradient_checkpointing_enable()\n","    return model\n","model = initialize_model()"]},{"cell_type":"code","execution_count":null,"id":"075be418-828e-4c62-bb1a-f5bf0c8c7d9e","metadata":{"id":"075be418-828e-4c62-bb1a-f5bf0c8c7d9e"},"outputs":[],"source":["# Manually running bs 32 10 epochs due to a issue in random search\n","# Training arguments\n","training_args = TrainingArguments(\n","    output_dir=\"./results\",\n","    eval_strategy=\"no\",\n","    save_strategy=\"no\",\n","    learning_rate=1e-5,\n","    per_device_train_batch_size=32,\n","    per_device_eval_batch_size=32,\n","    num_train_epochs=10,\n","    weight_decay=0.01,\n","    load_best_model_at_end=True,\n","    fp16=True\n",")\n"]},{"cell_type":"code","execution_count":null,"id":"53111b9e-98ac-42ef-875b-187ddcf9e8ca","metadata":{"id":"53111b9e-98ac-42ef-875b-187ddcf9e8ca"},"outputs":[],"source":["trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=train_dataset,\n","    eval_dataset=dev_dataset,\n","    processing_class=tokenizer,\n","    compute_metrics=compute_metrics\n",")"]},{"cell_type":"code","execution_count":null,"id":"c5a70068-67c3-4ef7-a078-4f4977fb1bfd","metadata":{"id":"c5a70068-67c3-4ef7-a078-4f4977fb1bfd","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"error","timestamp":1734012285342,"user_tz":300,"elapsed":3718508,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"}},"outputId":"eb12b179-9654-469c-ad79-425e23eca5c8"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='43513' max='120930' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [ 43513/120930 1:01:48 < 1:49:59, 11.73 it/s, Epoch 3.60/10]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>500</td>\n","      <td>0.015300</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.015000</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>0.014800</td>\n","    </tr>\n","    <tr>\n","      <td>2000</td>\n","      <td>0.014300</td>\n","    </tr>\n","    <tr>\n","      <td>2500</td>\n","      <td>0.014300</td>\n","    </tr>\n","    <tr>\n","      <td>3000</td>\n","      <td>0.014000</td>\n","    </tr>\n","    <tr>\n","      <td>3500</td>\n","      <td>0.013800</td>\n","    </tr>\n","    <tr>\n","      <td>4000</td>\n","      <td>0.013600</td>\n","    </tr>\n","    <tr>\n","      <td>4500</td>\n","      <td>0.013400</td>\n","    </tr>\n","    <tr>\n","      <td>5000</td>\n","      <td>0.013300</td>\n","    </tr>\n","    <tr>\n","      <td>5500</td>\n","      <td>0.013100</td>\n","    </tr>\n","    <tr>\n","      <td>6000</td>\n","      <td>0.012900</td>\n","    </tr>\n","    <tr>\n","      <td>6500</td>\n","      <td>0.012800</td>\n","    </tr>\n","    <tr>\n","      <td>7000</td>\n","      <td>0.012800</td>\n","    </tr>\n","    <tr>\n","      <td>7500</td>\n","      <td>0.012500</td>\n","    </tr>\n","    <tr>\n","      <td>8000</td>\n","      <td>0.012300</td>\n","    </tr>\n","    <tr>\n","      <td>8500</td>\n","      <td>0.012200</td>\n","    </tr>\n","    <tr>\n","      <td>9000</td>\n","      <td>0.012200</td>\n","    </tr>\n","    <tr>\n","      <td>9500</td>\n","      <td>0.012000</td>\n","    </tr>\n","    <tr>\n","      <td>10000</td>\n","      <td>0.011900</td>\n","    </tr>\n","    <tr>\n","      <td>10500</td>\n","      <td>0.011900</td>\n","    </tr>\n","    <tr>\n","      <td>11000</td>\n","      <td>0.011900</td>\n","    </tr>\n","    <tr>\n","      <td>11500</td>\n","      <td>0.011700</td>\n","    </tr>\n","    <tr>\n","      <td>12000</td>\n","      <td>0.011500</td>\n","    </tr>\n","    <tr>\n","      <td>12500</td>\n","      <td>0.011400</td>\n","    </tr>\n","    <tr>\n","      <td>13000</td>\n","      <td>0.011400</td>\n","    </tr>\n","    <tr>\n","      <td>13500</td>\n","      <td>0.011200</td>\n","    </tr>\n","    <tr>\n","      <td>14000</td>\n","      <td>0.011300</td>\n","    </tr>\n","    <tr>\n","      <td>14500</td>\n","      <td>0.011200</td>\n","    </tr>\n","    <tr>\n","      <td>15000</td>\n","      <td>0.011100</td>\n","    </tr>\n","    <tr>\n","      <td>15500</td>\n","      <td>0.010900</td>\n","    </tr>\n","    <tr>\n","      <td>16000</td>\n","      <td>0.011000</td>\n","    </tr>\n","    <tr>\n","      <td>16500</td>\n","      <td>0.011100</td>\n","    </tr>\n","    <tr>\n","      <td>17000</td>\n","      <td>0.010900</td>\n","    </tr>\n","    <tr>\n","      <td>17500</td>\n","      <td>0.010800</td>\n","    </tr>\n","    <tr>\n","      <td>18000</td>\n","      <td>0.010700</td>\n","    </tr>\n","    <tr>\n","      <td>18500</td>\n","      <td>0.010700</td>\n","    </tr>\n","    <tr>\n","      <td>19000</td>\n","      <td>0.010700</td>\n","    </tr>\n","    <tr>\n","      <td>19500</td>\n","      <td>0.010700</td>\n","    </tr>\n","    <tr>\n","      <td>20000</td>\n","      <td>0.010500</td>\n","    </tr>\n","    <tr>\n","      <td>20500</td>\n","      <td>0.010600</td>\n","    </tr>\n","    <tr>\n","      <td>21000</td>\n","      <td>0.010500</td>\n","    </tr>\n","    <tr>\n","      <td>21500</td>\n","      <td>0.010400</td>\n","    </tr>\n","    <tr>\n","      <td>22000</td>\n","      <td>0.010400</td>\n","    </tr>\n","    <tr>\n","      <td>22500</td>\n","      <td>0.010400</td>\n","    </tr>\n","    <tr>\n","      <td>23000</td>\n","      <td>0.010300</td>\n","    </tr>\n","    <tr>\n","      <td>23500</td>\n","      <td>0.010300</td>\n","    </tr>\n","    <tr>\n","      <td>24000</td>\n","      <td>0.010200</td>\n","    </tr>\n","    <tr>\n","      <td>24500</td>\n","      <td>0.010100</td>\n","    </tr>\n","    <tr>\n","      <td>25000</td>\n","      <td>0.010000</td>\n","    </tr>\n","    <tr>\n","      <td>25500</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>26000</td>\n","      <td>0.010000</td>\n","    </tr>\n","    <tr>\n","      <td>26500</td>\n","      <td>0.010000</td>\n","    </tr>\n","    <tr>\n","      <td>27000</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>27500</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>28000</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>28500</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>29000</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>29500</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>30000</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>30500</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>31000</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>31500</td>\n","      <td>0.009600</td>\n","    </tr>\n","    <tr>\n","      <td>32000</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>32500</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>33000</td>\n","      <td>0.009600</td>\n","    </tr>\n","    <tr>\n","      <td>33500</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>34000</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>34500</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>35000</td>\n","      <td>0.009400</td>\n","    </tr>\n","    <tr>\n","      <td>35500</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>36000</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>36500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>37000</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>37500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>38000</td>\n","      <td>0.009300</td>\n","    </tr>\n","    <tr>\n","      <td>38500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>39000</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>39500</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>40000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>40500</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>41000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>41500</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>42000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>42500</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>43000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>43500</td>\n","      <td>0.009000</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-35-e5e6b3b9574e>\u001b[0m in \u001b[0;36m<cell line: 2>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# Train the model\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0mtrainer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(self, resume_from_checkpoint, trial, ignore_keys_for_eval, **kwargs)\u001b[0m\n\u001b[1;32m   2121\u001b[0m                 \u001b[0mhf_hub_utils\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0menable_progress_bars\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2122\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2123\u001b[0;31m             return inner_training_loop(\n\u001b[0m\u001b[1;32m   2124\u001b[0m                 \u001b[0margs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2125\u001b[0m                 \u001b[0mresume_from_checkpoint\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mresume_from_checkpoint\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36m_inner_training_loop\u001b[0;34m(self, batch_size, args, resume_from_checkpoint, trial, ignore_keys_for_eval)\u001b[0m\n\u001b[1;32m   2532\u001b[0m                         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallback_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_pre_optimizer_step\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2533\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2534\u001b[0;31m                         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2535\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2536\u001b[0m                         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallback_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_optimizer_step\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/accelerate/optimizer.py\u001b[0m in \u001b[0;36mstep\u001b[0;34m(self, closure)\u001b[0m\n\u001b[1;32m    156\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_optimizer_patched_step_method\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    157\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 158\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mscaler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moptimizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mclosure\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    159\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mscaler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mupdate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    160\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/amp/grad_scaler.py\u001b[0m in \u001b[0;36mstep\u001b[0;34m(self, optimizer, *args, **kwargs)\u001b[0m\n\u001b[1;32m    455\u001b[0m         ), \"No inf checks were recorded for this optimizer.\"\n\u001b[1;32m    456\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 457\u001b[0;31m         \u001b[0mretval\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_maybe_opt_step\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moptimizer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0moptimizer_state\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    458\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    459\u001b[0m         \u001b[0moptimizer_state\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"stage\"\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mOptState\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mSTEPPED\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/amp/grad_scaler.py\u001b[0m in \u001b[0;36m_maybe_opt_step\u001b[0;34m(self, optimizer, optimizer_state, *args, **kwargs)\u001b[0m\n\u001b[1;32m    350\u001b[0m         \u001b[0mretval\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mOptional\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mfloat\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    351\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0msum\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mv\u001b[0m \u001b[0;32min\u001b[0m \u001b[0moptimizer_state\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"found_inf_per_device\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 352\u001b[0;31m             \u001b[0mretval\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    353\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mretval\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    354\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/accelerate/optimizer.py\u001b[0m in \u001b[0;36mpatched_step\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    201\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mpatched_step\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    202\u001b[0m         \u001b[0maccelerated_optimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_accelerate_step_called\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 203\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mmethod\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    204\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    205\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mpatched_step\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/lr_scheduler.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    135\u001b[0m                     \u001b[0mopt\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mopt_ref\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    136\u001b[0m                     \u001b[0mopt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_opt_called\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m  \u001b[0;31m# type: ignore[union-attr]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 137\u001b[0;31m                     \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__get__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mopt\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mopt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__class__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    138\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    139\u001b[0m                 \u001b[0mwrapper\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_wrapped_by_lr_sched\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m  \u001b[0;31m# type: ignore[attr-defined]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    485\u001b[0m                             )\n\u001b[1;32m    486\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 487\u001b[0;31m                 \u001b[0mout\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    488\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_optimizer_step_code\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    489\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py\u001b[0m in \u001b[0;36m_use_grad\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m     89\u001b[0m             \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mset_grad_enabled\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdefaults\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m\"differentiable\"\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     90\u001b[0m             \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dynamo\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgraph_break\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 91\u001b[0;31m             \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     92\u001b[0m         \u001b[0;32mfinally\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     93\u001b[0m             \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dynamo\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgraph_break\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py\u001b[0m in \u001b[0;36mstep\u001b[0;34m(self, closure)\u001b[0m\n\u001b[1;32m    218\u001b[0m             )\n\u001b[1;32m    219\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 220\u001b[0;31m             adamw(\n\u001b[0m\u001b[1;32m    221\u001b[0m                 \u001b[0mparams_with_grad\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    222\u001b[0m                 \u001b[0mgrads\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py\u001b[0m in \u001b[0;36mmaybe_fallback\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    152\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mdisabled_func\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    153\u001b[0m             \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 154\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    155\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    156\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mmaybe_fallback\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py\u001b[0m in \u001b[0;36madamw\u001b[0;34m(params, grads, exp_avgs, exp_avg_sqs, max_exp_avg_sqs, state_steps, foreach, capturable, differentiable, fused, grad_scale, found_inf, has_complex, amsgrad, beta1, beta2, lr, weight_decay, eps, maximize)\u001b[0m\n\u001b[1;32m    780\u001b[0m         \u001b[0mfunc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_single_tensor_adamw\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    781\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 782\u001b[0;31m     func(\n\u001b[0m\u001b[1;32m    783\u001b[0m         \u001b[0mparams\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    784\u001b[0m         \u001b[0mgrads\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py\u001b[0m in \u001b[0;36m_multi_tensor_adamw\u001b[0;34m(params, grads, exp_avgs, exp_avg_sqs, max_exp_avg_sqs, state_steps, grad_scale, found_inf, amsgrad, beta1, beta2, lr, weight_decay, eps, maximize, capturable, differentiable, has_complex)\u001b[0m\n\u001b[1;32m    585\u001b[0m                 \u001b[0;36m1\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mbeta1\u001b[0m \u001b[0;34m**\u001b[0m \u001b[0m_get_value\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mstep\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdevice_state_steps\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    586\u001b[0m             ]\n\u001b[0;32m--> 587\u001b[0;31m             bias_correction2 = [\n\u001b[0m\u001b[1;32m    588\u001b[0m                 \u001b[0;36m1\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mbeta2\u001b[0m \u001b[0;34m**\u001b[0m \u001b[0m_get_value\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mstep\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdevice_state_steps\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    589\u001b[0m             ]\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m    586\u001b[0m             ]\n\u001b[1;32m    587\u001b[0m             bias_correction2 = [\n\u001b[0;32m--> 588\u001b[0;31m                 \u001b[0;36m1\u001b[0m \u001b[0;34m-\u001b[0m \u001b[0mbeta2\u001b[0m \u001b[0;34m**\u001b[0m \u001b[0m_get_value\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mstep\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mstep\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mdevice_state_steps\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    589\u001b[0m             ]\n\u001b[1;32m    590\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py\u001b[0m in \u001b[0;36m_get_value\u001b[0;34m(x)\u001b[0m\n\u001b[1;32m    104\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    105\u001b[0m     \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 106\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0misinstance\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTensor\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    107\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    108\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["trainer.train()"]},{"cell_type":"code","execution_count":null,"id":"f0a4f66a-b07c-46c7-bba8-f26d88542aab","metadata":{"id":"f0a4f66a-b07c-46c7-bba8-f26d88542aab"},"outputs":[],"source":["metrics = trainer.evaluate(test_dataset)\n","print(metrics)"]},{"cell_type":"code","source":["from sklearn.model_selection import train_test_split\n","\n","# Running best model without popularity\n","##No Popularity##\n","\n","# Data prep (same as above)\n","X = tracks[[\"name\", \"duration_ms\", \"explicit\", \"release_date\", \"energy\", \"danceability\", \"key\", \"loudness\", \"mode\", \"speechiness\", \"acousticness\", \"instrumentalness\", \"liveness\", \"valence\", \"tempo\", \"time_signature\"]]\n","y = tracks[\"multi_hot_genres\"].tolist()\n","\n","X_train, X_temp, y_train, y_temp = train_test_split(X, y, test_size=0.2, random_state=478)\n","X_dev, X_test, y_dev, y_test = train_test_split(X_temp, y_temp, test_size=0.5, random_state=478)\n","\n","print(f\"Train set size: {len(X_train)}\")\n","print(f\"Dev set size: {len(X_dev)}\")\n","print(f\"Test set size: {len(X_test)}\")\n","\n","\n","label_counts = np.sum(y_train, axis=0)\n","\n","threshold =100\n","selected_labels = np.where(label_counts >= threshold)[0]\n","\n","def filter_labels(y, selected_labels):\n","    return np.array([[y_sample[i] for i in selected_labels] for y_sample in y])\n","\n","y_train = filter_labels(y_train, selected_labels)\n","y_dev = filter_labels(y_dev, selected_labels)\n","y_test = filter_labels(y_test, selected_labels)\n","\n","filtered_genre_to_index = {genre: idx for idx, genre in enumerate(selected_labels)}\n","index_to_genre = {v: k for k, v in filtered_genre_to_index.items()}\n","\n","print(f\"Original number of labels: {len(label_counts)}\")\n","print(f\"Filtered number of labels: {len(selected_labels)}\")\n","\n","def remove_empty_labels(X, y):\n","    non_empty_indices = [i for i, labels in enumerate(y) if np.sum(labels) > 0]\n","    X_filtered = X.iloc[non_empty_indices].reset_index(drop=True)\n","    y_filtered = np.array([y[i] for i in non_empty_indices])\n","    return X_filtered, y_filtered\n","\n","X_train, y_train = remove_empty_labels(X_train, y_train)\n","X_dev, y_dev = remove_empty_labels(X_dev, y_dev)\n","X_test, y_test = remove_empty_labels(X_test, y_test)\n","\n","print(f\"Train set size after filtering: {len(X_train)}\")\n","print(f\"Dev set size after filtering: {len(X_dev)}\")\n","print(f\"Test set size after filtering: {len(X_test)}\")\n","\n","def tokenize_data(X):\n","    combined_text = X.apply(lambda row: \" \".join(row.astype(str)), axis=1)\n","\n","    return tokenizer(\n","        combined_text.tolist(),\n","        padding=True,\n","        truncation=True,\n","        max_length=128,\n","        return_tensors=\"pt\"\n","    )\n","\n","train_dataset = MultiLabelDataset(X_train, y_train)\n","dev_dataset = MultiLabelDataset(X_dev, y_dev)\n","test_dataset = MultiLabelDataset(X_test, y_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"DsB2YR-JL9-D","executionInfo":{"status":"ok","timestamp":1734012998086,"user_tz":300,"elapsed":417658,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"}},"outputId":"3d343942-af73-4108-f8dd-ef9fa3aa6f79"},"id":"DsB2YR-JL9-D","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Train set size: 399251\n","Dev set size: 49906\n","Test set size: 49907\n","Original number of labels: 4706\n","Filtered number of labels: 1529\n","Train set size after filtering: 386974\n","Dev set size after filtering: 48297\n","Test set size after filtering: 48376\n","Token length range: 128 to 128\n","Token length range: 128 to 128\n","Token length range: 128 to 128\n"]}]},{"cell_type":"code","source":["num_labels = len(y_train[0])\n","model = MultiLabelRoBERTa(num_labels=num_labels)\n","model.roberta.gradient_checkpointing_enable()\n","training_args = TrainingArguments(\n","    output_dir=\"./results\",\n","    eval_strategy=\"no\",\n","    save_strategy=\"no\",\n","    learning_rate=1e-5,\n","    per_device_train_batch_size=32,\n","    per_device_eval_batch_size=16,\n","    num_train_epochs=10,\n","    weight_decay=0.01,\n","    load_best_model_at_end=True,\n","    fp16=True\n",")\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=train_dataset,\n","    eval_dataset=dev_dataset,\n","    processing_class=tokenizer,\n","    compute_metrics=compute_metrics\n",")\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XOWUtMq_MPMV","executionInfo":{"status":"ok","timestamp":1734013158756,"user_tz":300,"elapsed":489,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"}},"outputId":"b0e4f9e7-1a64-4b18-8d39-6c482369e61e"},"id":"XOWUtMq_MPMV","execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of RobertaModel were not initialized from the model checkpoint at roberta-base and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}]},{"cell_type":"code","source":["# # Train the model\n","#NO Popularity\n","trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"dzC8uvwjM9lF","executionInfo":{"status":"ok","timestamp":1734023148199,"user_tz":300,"elapsed":9980631,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"}},"outputId":"84e8c3a3-2502-4cea-c571-bb27e30bea53"},"id":"dzC8uvwjM9lF","execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='120930' max='120930' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [120930/120930 2:46:20, Epoch 10/10]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>500</td>\n","      <td>0.526800</td>\n","    </tr>\n","    <tr>\n","      <td>1000</td>\n","      <td>0.186800</td>\n","    </tr>\n","    <tr>\n","      <td>1500</td>\n","      <td>0.067900</td>\n","    </tr>\n","    <tr>\n","      <td>2000</td>\n","      <td>0.039500</td>\n","    </tr>\n","    <tr>\n","      <td>2500</td>\n","      <td>0.031100</td>\n","    </tr>\n","    <tr>\n","      <td>3000</td>\n","      <td>0.027000</td>\n","    </tr>\n","    <tr>\n","      <td>3500</td>\n","      <td>0.024400</td>\n","    </tr>\n","    <tr>\n","      <td>4000</td>\n","      <td>0.022700</td>\n","    </tr>\n","    <tr>\n","      <td>4500</td>\n","      <td>0.021300</td>\n","    </tr>\n","    <tr>\n","      <td>5000</td>\n","      <td>0.020300</td>\n","    </tr>\n","    <tr>\n","      <td>5500</td>\n","      <td>0.019400</td>\n","    </tr>\n","    <tr>\n","      <td>6000</td>\n","      <td>0.018700</td>\n","    </tr>\n","    <tr>\n","      <td>6500</td>\n","      <td>0.018100</td>\n","    </tr>\n","    <tr>\n","      <td>7000</td>\n","      <td>0.017600</td>\n","    </tr>\n","    <tr>\n","      <td>7500</td>\n","      <td>0.017000</td>\n","    </tr>\n","    <tr>\n","      <td>8000</td>\n","      <td>0.016300</td>\n","    </tr>\n","    <tr>\n","      <td>8500</td>\n","      <td>0.016000</td>\n","    </tr>\n","    <tr>\n","      <td>9000</td>\n","      <td>0.015700</td>\n","    </tr>\n","    <tr>\n","      <td>9500</td>\n","      <td>0.015300</td>\n","    </tr>\n","    <tr>\n","      <td>10000</td>\n","      <td>0.015000</td>\n","    </tr>\n","    <tr>\n","      <td>10500</td>\n","      <td>0.014900</td>\n","    </tr>\n","    <tr>\n","      <td>11000</td>\n","      <td>0.014700</td>\n","    </tr>\n","    <tr>\n","      <td>11500</td>\n","      <td>0.014300</td>\n","    </tr>\n","    <tr>\n","      <td>12000</td>\n","      <td>0.014000</td>\n","    </tr>\n","    <tr>\n","      <td>12500</td>\n","      <td>0.013800</td>\n","    </tr>\n","    <tr>\n","      <td>13000</td>\n","      <td>0.013800</td>\n","    </tr>\n","    <tr>\n","      <td>13500</td>\n","      <td>0.013500</td>\n","    </tr>\n","    <tr>\n","      <td>14000</td>\n","      <td>0.013500</td>\n","    </tr>\n","    <tr>\n","      <td>14500</td>\n","      <td>0.013300</td>\n","    </tr>\n","    <tr>\n","      <td>15000</td>\n","      <td>0.013200</td>\n","    </tr>\n","    <tr>\n","      <td>15500</td>\n","      <td>0.012900</td>\n","    </tr>\n","    <tr>\n","      <td>16000</td>\n","      <td>0.012800</td>\n","    </tr>\n","    <tr>\n","      <td>16500</td>\n","      <td>0.012900</td>\n","    </tr>\n","    <tr>\n","      <td>17000</td>\n","      <td>0.012600</td>\n","    </tr>\n","    <tr>\n","      <td>17500</td>\n","      <td>0.012500</td>\n","    </tr>\n","    <tr>\n","      <td>18000</td>\n","      <td>0.012400</td>\n","    </tr>\n","    <tr>\n","      <td>18500</td>\n","      <td>0.012300</td>\n","    </tr>\n","    <tr>\n","      <td>19000</td>\n","      <td>0.012300</td>\n","    </tr>\n","    <tr>\n","      <td>19500</td>\n","      <td>0.012300</td>\n","    </tr>\n","    <tr>\n","      <td>20000</td>\n","      <td>0.012100</td>\n","    </tr>\n","    <tr>\n","      <td>20500</td>\n","      <td>0.012100</td>\n","    </tr>\n","    <tr>\n","      <td>21000</td>\n","      <td>0.012000</td>\n","    </tr>\n","    <tr>\n","      <td>21500</td>\n","      <td>0.011900</td>\n","    </tr>\n","    <tr>\n","      <td>22000</td>\n","      <td>0.011800</td>\n","    </tr>\n","    <tr>\n","      <td>22500</td>\n","      <td>0.011700</td>\n","    </tr>\n","    <tr>\n","      <td>23000</td>\n","      <td>0.011600</td>\n","    </tr>\n","    <tr>\n","      <td>23500</td>\n","      <td>0.011600</td>\n","    </tr>\n","    <tr>\n","      <td>24000</td>\n","      <td>0.011500</td>\n","    </tr>\n","    <tr>\n","      <td>24500</td>\n","      <td>0.011400</td>\n","    </tr>\n","    <tr>\n","      <td>25000</td>\n","      <td>0.011200</td>\n","    </tr>\n","    <tr>\n","      <td>25500</td>\n","      <td>0.011100</td>\n","    </tr>\n","    <tr>\n","      <td>26000</td>\n","      <td>0.011200</td>\n","    </tr>\n","    <tr>\n","      <td>26500</td>\n","      <td>0.011200</td>\n","    </tr>\n","    <tr>\n","      <td>27000</td>\n","      <td>0.011000</td>\n","    </tr>\n","    <tr>\n","      <td>27500</td>\n","      <td>0.011100</td>\n","    </tr>\n","    <tr>\n","      <td>28000</td>\n","      <td>0.011000</td>\n","    </tr>\n","    <tr>\n","      <td>28500</td>\n","      <td>0.011000</td>\n","    </tr>\n","    <tr>\n","      <td>29000</td>\n","      <td>0.010900</td>\n","    </tr>\n","    <tr>\n","      <td>29500</td>\n","      <td>0.010900</td>\n","    </tr>\n","    <tr>\n","      <td>30000</td>\n","      <td>0.010900</td>\n","    </tr>\n","    <tr>\n","      <td>30500</td>\n","      <td>0.010800</td>\n","    </tr>\n","    <tr>\n","      <td>31000</td>\n","      <td>0.010800</td>\n","    </tr>\n","    <tr>\n","      <td>31500</td>\n","      <td>0.010600</td>\n","    </tr>\n","    <tr>\n","      <td>32000</td>\n","      <td>0.010700</td>\n","    </tr>\n","    <tr>\n","      <td>32500</td>\n","      <td>0.010700</td>\n","    </tr>\n","    <tr>\n","      <td>33000</td>\n","      <td>0.010600</td>\n","    </tr>\n","    <tr>\n","      <td>33500</td>\n","      <td>0.010600</td>\n","    </tr>\n","    <tr>\n","      <td>34000</td>\n","      <td>0.010500</td>\n","    </tr>\n","    <tr>\n","      <td>34500</td>\n","      <td>0.010400</td>\n","    </tr>\n","    <tr>\n","      <td>35000</td>\n","      <td>0.010300</td>\n","    </tr>\n","    <tr>\n","      <td>35500</td>\n","      <td>0.010400</td>\n","    </tr>\n","    <tr>\n","      <td>36000</td>\n","      <td>0.010400</td>\n","    </tr>\n","    <tr>\n","      <td>36500</td>\n","      <td>0.010200</td>\n","    </tr>\n","    <tr>\n","      <td>37000</td>\n","      <td>0.010100</td>\n","    </tr>\n","    <tr>\n","      <td>37500</td>\n","      <td>0.010100</td>\n","    </tr>\n","    <tr>\n","      <td>38000</td>\n","      <td>0.010200</td>\n","    </tr>\n","    <tr>\n","      <td>38500</td>\n","      <td>0.010100</td>\n","    </tr>\n","    <tr>\n","      <td>39000</td>\n","      <td>0.010100</td>\n","    </tr>\n","    <tr>\n","      <td>39500</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>40000</td>\n","      <td>0.010000</td>\n","    </tr>\n","    <tr>\n","      <td>40500</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>41000</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>41500</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>42000</td>\n","      <td>0.009900</td>\n","    </tr>\n","    <tr>\n","      <td>42500</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>43000</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>43500</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>44000</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>44500</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>45000</td>\n","      <td>0.009800</td>\n","    </tr>\n","    <tr>\n","      <td>45500</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>46000</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>46500</td>\n","      <td>0.009600</td>\n","    </tr>\n","    <tr>\n","      <td>47000</td>\n","      <td>0.009700</td>\n","    </tr>\n","    <tr>\n","      <td>47500</td>\n","      <td>0.009600</td>\n","    </tr>\n","    <tr>\n","      <td>48000</td>\n","      <td>0.009600</td>\n","    </tr>\n","    <tr>\n","      <td>48500</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>49000</td>\n","      <td>0.009400</td>\n","    </tr>\n","    <tr>\n","      <td>49500</td>\n","      <td>0.009500</td>\n","    </tr>\n","    <tr>\n","      <td>50000</td>\n","      <td>0.009400</td>\n","    </tr>\n","    <tr>\n","      <td>50500</td>\n","      <td>0.009400</td>\n","    </tr>\n","    <tr>\n","      <td>51000</td>\n","      <td>0.009400</td>\n","    </tr>\n","    <tr>\n","      <td>51500</td>\n","      <td>0.009300</td>\n","    </tr>\n","    <tr>\n","      <td>52000</td>\n","      <td>0.009300</td>\n","    </tr>\n","    <tr>\n","      <td>52500</td>\n","      <td>0.009400</td>\n","    </tr>\n","    <tr>\n","      <td>53000</td>\n","      <td>0.009300</td>\n","    </tr>\n","    <tr>\n","      <td>53500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>54000</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>54500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>55000</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>55500</td>\n","      <td>0.009300</td>\n","    </tr>\n","    <tr>\n","      <td>56000</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>56500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>57000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>57500</td>\n","      <td>0.009200</td>\n","    </tr>\n","    <tr>\n","      <td>58000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>58500</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>59000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>59500</td>\n","      <td>0.009000</td>\n","    </tr>\n","    <tr>\n","      <td>60000</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>60500</td>\n","      <td>0.009100</td>\n","    </tr>\n","    <tr>\n","      <td>61000</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>61500</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>62000</td>\n","      <td>0.009000</td>\n","    </tr>\n","    <tr>\n","      <td>62500</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>63000</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>63500</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>64000</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>64500</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>65000</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>65500</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>66000</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>66500</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>67000</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>67500</td>\n","      <td>0.008900</td>\n","    </tr>\n","    <tr>\n","      <td>68000</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>68500</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>69000</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>69500</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>70000</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>70500</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>71000</td>\n","      <td>0.008700</td>\n","    </tr>\n","    <tr>\n","      <td>71500</td>\n","      <td>0.008700</td>\n","    </tr>\n","    <tr>\n","      <td>72000</td>\n","      <td>0.008800</td>\n","    </tr>\n","    <tr>\n","      <td>72500</td>\n","      <td>0.008700</td>\n","    </tr>\n","    <tr>\n","      <td>73000</td>\n","      <td>0.008600</td>\n","    </tr>\n","    <tr>\n","      <td>73500</td>\n","      <td>0.008600</td>\n","    </tr>\n","    <tr>\n","      <td>74000</td>\n","      <td>0.008700</td>\n","    </tr>\n","    <tr>\n","      <td>74500</td>\n","      <td>0.008600</td>\n","    </tr>\n","    <tr>\n","      <td>75000</td>\n","      <td>0.008700</td>\n","    </tr>\n","    <tr>\n","      <td>75500</td>\n","      <td>0.008600</td>\n","    </tr>\n","    <tr>\n","      <td>76000</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>76500</td>\n","      <td>0.008600</td>\n","    </tr>\n","    <tr>\n","      <td>77000</td>\n","      <td>0.008600</td>\n","    </tr>\n","    <tr>\n","      <td>77500</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>78000</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>78500</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>79000</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>79500</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>80000</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>80500</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>81000</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>81500</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>82000</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>82500</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>83000</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>83500</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>84000</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>84500</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>85000</td>\n","      <td>0.008500</td>\n","    </tr>\n","    <tr>\n","      <td>85500</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>86000</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>86500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>87000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>87500</td>\n","      <td>0.008400</td>\n","    </tr>\n","    <tr>\n","      <td>88000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>88500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>89000</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>89500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>90000</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>90500</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>91000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>91500</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>92000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>92500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>93000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>93500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>94000</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>94500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>95000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>95500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>96000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>96500</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>97000</td>\n","      <td>0.008300</td>\n","    </tr>\n","    <tr>\n","      <td>97500</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>98000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>98500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>99000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>99500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>100000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>100500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>101000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>101500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>102000</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>102500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>103000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>103500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>104000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>104500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>105000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>105500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>106000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>106500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>107000</td>\n","      <td>0.008200</td>\n","    </tr>\n","    <tr>\n","      <td>107500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>108000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>108500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>109000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>109500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>110000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>110500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>111000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>111500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>112000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>112500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>113000</td>\n","      <td>0.007900</td>\n","    </tr>\n","    <tr>\n","      <td>113500</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>114000</td>\n","      <td>0.008100</td>\n","    </tr>\n","    <tr>\n","      <td>114500</td>\n","      <td>0.007900</td>\n","    </tr>\n","    <tr>\n","      <td>115000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>115500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>116000</td>\n","      <td>0.007900</td>\n","    </tr>\n","    <tr>\n","      <td>116500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>117000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>117500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>118000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>118500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>119000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>119500</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>120000</td>\n","      <td>0.008000</td>\n","    </tr>\n","    <tr>\n","      <td>120500</td>\n","      <td>0.008000</td>\n","    </tr>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=120930, training_loss=0.013363189710277803, metrics={'train_runtime': 9980.5151, 'train_samples_per_second': 387.729, 'train_steps_per_second': 12.117, 'total_flos': 0.0, 'train_loss': 0.013363189710277803, 'epoch': 10.0})"]},"metadata":{},"execution_count":40}]},{"cell_type":"code","source":["#Evaluate on test\n","metrics = trainer.evaluate(test_dataset)\n","print(metrics)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":74},"id":"IrDuLcyRM_y1","executionInfo":{"status":"ok","timestamp":1734024170068,"user_tz":300,"elapsed":1021873,"user":{"displayName":"Jude Mersinger","userId":"04053644871073057878"}},"outputId":"c2753514-94d4-49ab-be71-8bc763142e91"},"id":"IrDuLcyRM_y1","execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='3024' max='3024' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [3024/3024 01:02]\n","    </div>\n","    "]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.007743550464510918, 'eval_prob_min': 7.371428631444677e-16, 'eval_prob_max': 0.997730553150177, 'eval_prob_mean': 0.002057349542155862, 'eval_optimal_threshold': 0.2, 'eval_optimal_threshold_accuracy': 0.08276831486687614, 'eval_optimal_threshold_precision': 0.4896462960624049, 'eval_optimal_threshold_recall': 0.44455183334698445, 'eval_optimal_threshold_f1': 0.46601069249350324, 'eval_optimal_threshold_hamming': 0.00252245247414979, 'eval_optimal_threshold_jaccard': 0.3127024238211885, 'eval_runtime': 1021.8008, 'eval_samples_per_second': 47.344, 'eval_steps_per_second': 2.959, 'epoch': 10.0}\n"]}]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"A100","machine_shape":"hm","provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.9"},"widgets":{"application/vnd.jupyter.widget-state+json":{"12ad8940c62041619cb896596750d01a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_16998aabcc8d4bb9a3c0f24800597c91","IPY_MODEL_ee0d127edd664d4ea78ae374ecf0a93f","IPY_MODEL_d550d967cb1b43d8add0a84dc0c3588f"],"layout":"IPY_MODEL_bb89508e2e5548afad39a041130f3cef"}},"16998aabcc8d4bb9a3c0f24800597c91":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8b11fd7c38d449f6a1909dc73efc5263","placeholder":"​","style":"IPY_MODEL_c3fd94636d32446f8066458ea73c0e5b","value":"tokenizer_config.json: 100%"}},"ee0d127edd664d4ea78ae374ecf0a93f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c66ef153c98342239156e90731f203a7","max":25,"min":0,"orientation":"horizontal","style":"IPY_MODEL_66f2ec1c94ff4f9da0629c4c653a6373","value":25}},"d550d967cb1b43d8add0a84dc0c3588f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a14fd1192f5e4663a7eec560ebd825d7","placeholder":"​","style":"IPY_MODEL_b00718c1321a484594e0d8f1dcd76cbf","value":" 25.0/25.0 [00:00&lt;00:00, 2.06kB/s]"}},"bb89508e2e5548afad39a041130f3cef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8b11fd7c38d449f6a1909dc73efc5263":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c3fd94636d32446f8066458ea73c0e5b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c66ef153c98342239156e90731f203a7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"66f2ec1c94ff4f9da0629c4c653a6373":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a14fd1192f5e4663a7eec560ebd825d7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b00718c1321a484594e0d8f1dcd76cbf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"62dcbe9ecca2439bafdace5ffd229607":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3785465a5a52458aa968ce326abfa71b","IPY_MODEL_440f0731990a42e2b35e003e975f81d0","IPY_MODEL_c7aecc3a1a954aa89a0aa9f223c00629"],"layout":"IPY_MODEL_4bf7454220ad468a8401938b9d387e6b"}},"3785465a5a52458aa968ce326abfa71b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2018cfeddfee44ffb7cd8de0a5a72149","placeholder":"​","style":"IPY_MODEL_35941ca2a9734665ad3cb4062929189c","value":"vocab.json: 100%"}},"440f0731990a42e2b35e003e975f81d0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_70da06d6eaae45c9b51176e36ac0c2ce","max":898823,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a58682d922c24eb18949e2948c71742d","value":898823}},"c7aecc3a1a954aa89a0aa9f223c00629":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6b010ab2676344ad9b4fc41fe4ffd8ba","placeholder":"​","style":"IPY_MODEL_758210704e5f4e3d8390eeab0c1dc9a9","value":" 899k/899k [00:00&lt;00:00, 12.4MB/s]"}},"4bf7454220ad468a8401938b9d387e6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2018cfeddfee44ffb7cd8de0a5a72149":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"35941ca2a9734665ad3cb4062929189c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"70da06d6eaae45c9b51176e36ac0c2ce":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a58682d922c24eb18949e2948c71742d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6b010ab2676344ad9b4fc41fe4ffd8ba":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"758210704e5f4e3d8390eeab0c1dc9a9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ce2b282816ac4fc6a5cab01138c7e7dd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0a10cdc249574a07a6ece57d7a5407af","IPY_MODEL_242490e53cde4f5295f0d76d074cba17","IPY_MODEL_a3aa7be523c5445b8a9bb3df6739148e"],"layout":"IPY_MODEL_700b4e3ca58e45329d86b7bee6d25b81"}},"0a10cdc249574a07a6ece57d7a5407af":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_888252ddd7f043da8e31fbb067996dfb","placeholder":"​","style":"IPY_MODEL_9adee565216642c589d37b05c5a5c8f0","value":"merges.txt: 100%"}},"242490e53cde4f5295f0d76d074cba17":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_96274012f7da4572961b875390989a02","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cf9ecf4eef3b4af9822313ec536d2cd8","value":456318}},"a3aa7be523c5445b8a9bb3df6739148e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_456115a7f63646989c17613aee67c1cf","placeholder":"​","style":"IPY_MODEL_0329d59f979549d48d568b39c972c358","value":" 456k/456k [00:00&lt;00:00, 29.6MB/s]"}},"700b4e3ca58e45329d86b7bee6d25b81":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"888252ddd7f043da8e31fbb067996dfb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9adee565216642c589d37b05c5a5c8f0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"96274012f7da4572961b875390989a02":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cf9ecf4eef3b4af9822313ec536d2cd8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"456115a7f63646989c17613aee67c1cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0329d59f979549d48d568b39c972c358":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5508438f43134079b399a37af2c687fa":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fb6ba57418d345e68c1aa569b340497d","IPY_MODEL_8bda381ca84e4e67b14a775a22cb42a2","IPY_MODEL_32db3c3e49b14b48851584e1348b573b"],"layout":"IPY_MODEL_231765b191f047f583aafdbd59583101"}},"fb6ba57418d345e68c1aa569b340497d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3370ccc1b69d4c3e99b742b26e0da638","placeholder":"​","style":"IPY_MODEL_03fa76a5ad4f4d428d5e37a43f657068","value":"tokenizer.json: 100%"}},"8bda381ca84e4e67b14a775a22cb42a2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_460219bcc9194e0a9ef8b92dc831293b","max":1355863,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f6c3339df8244572bf8b6b1415ab3538","value":1355863}},"32db3c3e49b14b48851584e1348b573b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_33ca2f3509134a7ca85a865160604dc9","placeholder":"​","style":"IPY_MODEL_2af7e352b446441fafbd2a42c7066337","value":" 1.36M/1.36M [00:00&lt;00:00, 15.4MB/s]"}},"231765b191f047f583aafdbd59583101":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3370ccc1b69d4c3e99b742b26e0da638":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"03fa76a5ad4f4d428d5e37a43f657068":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"460219bcc9194e0a9ef8b92dc831293b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f6c3339df8244572bf8b6b1415ab3538":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"33ca2f3509134a7ca85a865160604dc9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2af7e352b446441fafbd2a42c7066337":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"438dc3c9c9474b4ebbeb2198f7310cce":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_946ef0e479954acbbaff5a3b115bfa49","IPY_MODEL_25e0421b61f0403c9f44b5464a5a1fb0","IPY_MODEL_c8182fd7b96540d7a600b5dd27a0dc52"],"layout":"IPY_MODEL_9a2d2f6982d14a7190825a500a1f5617"}},"946ef0e479954acbbaff5a3b115bfa49":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_21a8ab9d99fd4b7b96f4c5710b1cacc8","placeholder":"​","style":"IPY_MODEL_eecc23c817954bf8b88f47d4044363ca","value":"config.json: 100%"}},"25e0421b61f0403c9f44b5464a5a1fb0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_55544cb3f8a4492e9d7d7f30c6760d7e","max":481,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6a9acf3444c14dadb2637a6259327f77","value":481}},"c8182fd7b96540d7a600b5dd27a0dc52":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fc969e441dbc4e42a042251df159c66e","placeholder":"​","style":"IPY_MODEL_e6e6f5c364844126a57b4c3ac013484c","value":" 481/481 [00:00&lt;00:00, 34.9kB/s]"}},"9a2d2f6982d14a7190825a500a1f5617":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"21a8ab9d99fd4b7b96f4c5710b1cacc8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eecc23c817954bf8b88f47d4044363ca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"55544cb3f8a4492e9d7d7f30c6760d7e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6a9acf3444c14dadb2637a6259327f77":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"fc969e441dbc4e42a042251df159c66e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e6e6f5c364844126a57b4c3ac013484c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1dbb6fbb00124f5ea2bb59122be83c31":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_75d3756e74944ba19406cc24aa58c5ce","IPY_MODEL_52f95d752c7f4db98619c721f2a93b2b","IPY_MODEL_4ec008e869f44abca34f7518260a114c"],"layout":"IPY_MODEL_a9de6250046e4e8dacd4d0817d31ab87"}},"75d3756e74944ba19406cc24aa58c5ce":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0dfa43fa48a1458b9e0cb7227940ece1","placeholder":"​","style":"IPY_MODEL_fb9dc9a1da02497595ca5bcda139dc8e","value":"model.safetensors: 100%"}},"52f95d752c7f4db98619c721f2a93b2b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c8ed270d3a1f4f90b3a7cfe30d5add7a","max":498818054,"min":0,"orientation":"horizontal","style":"IPY_MODEL_01e439f92f284f52b67eb5df4a4d3454","value":498818054}},"4ec008e869f44abca34f7518260a114c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f199adcfbb6d4c9d9d32e5d695459fed","placeholder":"​","style":"IPY_MODEL_32db3ee74a484beba2736f4d70ae674e","value":" 499M/499M [00:02&lt;00:00, 244MB/s]"}},"a9de6250046e4e8dacd4d0817d31ab87":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0dfa43fa48a1458b9e0cb7227940ece1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fb9dc9a1da02497595ca5bcda139dc8e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c8ed270d3a1f4f90b3a7cfe30d5add7a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"01e439f92f284f52b67eb5df4a4d3454":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f199adcfbb6d4c9d9d32e5d695459fed":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32db3ee74a484beba2736f4d70ae674e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":5}